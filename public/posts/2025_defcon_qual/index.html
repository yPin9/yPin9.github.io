<!DOCTYPE html>
<html lang="en" data-theme="light">
<script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Defcon qual CTF 2025 | yiπng</title>

<link rel="stylesheet" href="http://localhost:1313//css/styles.css">
<link rel="stylesheet" href="http://localhost:1313//css/custom.css">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/all.css" 
integrity="sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ" crossorigin="anonymous">
<script src="https://code.jquery.com/jquery-3.3.1.js" integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60=" crossorigin="anonymous"></script>


<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials.css" />
<link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.jssocials/1.4.0/jssocials-theme-minima.css" />
<script type="text/javascript" src="http://localhost:1313//js/jssocials.js"></script>


<div class="container">
    <nav class="navbar level">
      <div class="navbar-brand">
          <a class="nav-item" href="http://localhost:1313/"><h1 class="title is-3">yiπng</h1></a>
      </div>           
      <div class="navbar-menu has-text-centered is-active">
          <div class="navbar-end is-centered">
              
                <a href="http://localhost:1313/about" rel="me">
                  <span class="icon">
                    <i class="fas fa-info"></i>
                  </span>
                </a>
              
                <a href="https://github.com/yPin9" rel="me">
                  <span class="icon">
                    <i class="fab fa-github"></i>
                  </span>
                </a>
              
                <a href="https://x.com/ypp_tw" rel="me">
                  <span class="icon">
                    <i class="fab fa-twitter"></i>
                  </span>
                </a>
              
           </div>
      </div>
    </nav>
  </div>

<div class="container">
  <h2 class="subtitle is-6">April 18, 2025</h2>
  <h1 class="subtitle is-size-4-mobile is-size-3-desktop">Defcon qual CTF 2025</h1>
  <div class="content">
    <p>運氣很好，解了一題</p>
<h3 id="rainbow-mountain">Rainbow Mountain</h3>
<p><a href="https://github.com/yPin9/CTF-Writeup/tree/main/DEFCON%20QUAL%202025">Download binary</a></p>
<h2 id="程式邏輯">程式邏輯</h2>
<ul>
<li>user 可以輸入兩次，第一次選擇 function</li>
<li>binary 提供 2000 個 function 供 user invoke</li>
<li>user 可以輸入兩次，第一次選擇 function</li>
<li>第二次輸入是調用這個 function 的參數</li>
<li>然後這個調用的方式它寫的很醜，逆了一陣子才知道他就是單純調用，它裡面塞了一些沒用的 function(function 的功能就是返回帶進去的參數)</li>
<li>每個 function 的功能其實就是比對 stack 中的某兩個 8bytes 的值是否一樣</li>
<li>然後某些 function 有 overflow 0~4 bytes，這是工人智慧出來的</li>
</ul>
<h3 id="解題思路">解題思路</h3>
<ul>
<li>所以弄了一個 script，對每個 function 塞 1500 個 <code>A</code></li>
</ul>
<blockquote>
<p>這邊很幸運，因為 1500 個 A 是迴文，他其實有個判斷檢查 input 是不是迴文</p>
</blockquote>
<ul>
<li>發現其中 1576 可以 overflow 8 個 bytes</li>
<li>然後進去看他的判斷條件是要蓋成<code>4GxC95IF</code> 這個</li>
<li>就拿去 base64 encode 然後餵給程式</li>
<li>比較特別的是他在比對之前會進行一個迴文的判斷，所以最後的 payload 會長這樣 : <code>NEd4Qzk1SUZBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUZJNTlDeEc0</code></li>
</ul>

  </div>
</div>
<div class="container has-text-centered">
  
</div>

<section class="section py-0">
  <div class="container has-text-centered">
    <p></p>
  </div>
</section>

